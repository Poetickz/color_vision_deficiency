
intensity_rgb = {
                 0.100000279: 0.0, 0.101000289: 0.053102737968577, 0.103000299: 0.12345715626236514, 0.104000309: 0.17958435334063186,
                 0.106000318: 0.22073498146307285, 0.108000327: 0.2513400112001875, 0.109000335: 0.2686947576515937, 0.111000343: 0.2765411705238124, 
                 0.113000349: 0.27750471884526334, 0.116000355: 0.27271763703186386, 0.118000361: 0.264215422591702, 0.121000365: 0.2528715984040185, 
                 0.124000369: 0.239083937120996, 0.127000371: 0.2253459858234353, 0.130000373: 0.21146073133969842, 0.133000375: 0.19766802943011358, 
                 0.134000376: 0.18451800472435056, 0.135000377: 0.17180226609157742, 0.135000378: 0.160080764360928, 0.133000379: 0.1481894103261379, 
                 0.13200038: 0.13793894916097832, 0.129000381: 0.12848267485705162, 0.127000381: 0.11972406542747717, 0.124000381: 0.11164346635181413, 
                 0.120000382: 0.10417034501273933, 0.117000382: 0.09723709252485913, 0.112000382: 0.0908017465655925, 0.108000381: 0.08476390412648174, 
                 0.103000381: 0.07870322763771943, 0.09700038: 0.07334046638791672, 0.09000038: 0.06820236327828987, 0.082000379: 0.063197160088991, 
                 0.073000378: 0.058316059701416, 0.062000377: 0.05340781531576357, 0.048000375: 0.04852370122204457, 0.026000374: 0.04345963160248757, 
                 3.72e-07: 0.03833975284420228, 3.7e-07: 0.03291574730701857, 3.68e-07: 0.027414158783169714, 3.65e-07: 0.0211839637418565, 
                 3.62e-07: 0.0152436947463365, 3.59e-07: 0.009228899464869624, 3.55e-07: 0.0032636213618713336, 3.51e-07: 0.0, 3.46e-07: 0.0, 
                 3.41e-07: 0.0, 2.9336e-05: 0.0, 4.7331e-05: 0.0, 5.9325e-05: 0.0, 6.9319e-05: 0.0, 7.8313e-05: 0.0, 8.5307e-05: 0.0, 9.33e-05: 0.0, 
                 9.9294e-05: 0.0, 0.000105287: 0.0, 0.00011128: 0.0, 0.000117274: 0.0, 0.000122267: 0.0, 0.000127261: 0.0, 0.000132254: 0.0, 0.000137248: 0.0, 
                 0.000142241: 0.0, 0.000147235: 0.0, 0.000151229: 0.0, 0.000155222: 0.0, 0.000160216: 0.0, 0.00016421: 0.0, 0.000168205: 0.0, 
                 0.000172199: 0.0, 0.000176193: 0.0, 0.000181188: 0.0, 0.000185182: 0.0, 0.000189177: 0.0, 0.000193171: 0.0, 0.000197166: 0.0, 
                 0.000201161: 0.0, 0.000205155: 0.0, 0.00020915: 0.005006688651884, 0.000213145: 0.011969811365385713, 0.000217139: 0.02032239579992314, 
                 0.000221134: 0.030068125347769713, 0.000225128: 0.041406944633452, 0.000229123: 0.054235201966917286, 0.000233117: 0.06865371947353628, 
                 0.000237111: 0.08441725179754943, 0.000241105: 0.10146463116691642, 0.000245098: 0.11940347953054986, 0.000249091: 0.13797253412651914, 
                 0.000253084: 0.15667108036029442, 0.000257076: 0.17505026437954357, 0.000261068: 0.19133790440881182, 0.000265058: 0.20763445501592387, 
                 0.000268046: 0.22204126730948684, 0.000272031: 0.234154537469728, 0.000275: 0.24366015070967917, 0.000279: 0.250215245134257, 
                 0.000282: 0.253929306737311, 0.000285: 0.25471139566465273, 0.000288: 0.25313979223944033, 0.000291: 0.24957689853472936, 0.000293: 0.244989799717408, 
                 0.000296: 0.2402218408643836, 0.000298: 0.15247441871790415, 0.0003: 0.18492885730008243, 0.000302: 0.19918848356288166, 0.000303: 0.21316945584249863, 
                 0.000304: 0.225675901256224, 0.000305: 0.23614583042218676, 0.000306: 0.2445748771334815, 0.000307: 0.2504794562012165, 0.000308: 0.255061969035263, 
                 0.000309: 0.25103330967263343, 0.000299: 0.16916618708564113, 0.012296: 0.13611031121645328, 0.068294: 0.120589147470475, 0.095293: 0.10539804329649571, 
                 0.115291: 0.08897686747826, 0.131289: 0.075078024821475, 0.145287: 0.062234602546184715, 0.158285: 0.05144737331123184, 
                 0.170283: 0.04100794524851638, 0.18128: 0.0318383030792505, 0.191278: 0.0238896293420665, 0.201276: 0.017072443517987833, 
                 0.210273: 0.01134271440032525, 0.21827: 0.006539354683617166, 0.226268: 0.002843946544978143, 0.234265: 0.0, 0.242262: 0.0, 
                 0.249259: 0.0, 0.256256: 0.0, 0.262253: 0.0, 0.269249: 0.0, 0.275246: 0.0, 0.281242: 0.0, 0.286239: 0.0, 0.292235: 0.0, 0.297231: 0.0, 
                 0.302227: 0.0, 0.307223: 0.0, 0.312219: 0.0, 0.316215: 0.0, 0.32121: 0.0, 0.325206: 0.0, 0.329201: 0.0, 0.332196: 0.0, 0.336191: 0.0, 
                 0.339186: 0.0, 0.343181: 0.0, 0.346176: 0.0, 0.34917: 0.0005931232408913967, 0.351164: 0.004876149188947857, 0.354158: 0.010539018996576143, 
                 0.356152: 0.01760566586411043, 0.358146: 0.026515155352900287, 0.36014: 0.03647104126737683, 0.362133: 0.04951813278525712, 
                 0.364126: 0.0647561804238495, 0.366118: 0.08272956836841237, 0.36711: 0.10309912612601983, 0.368102: 0.124569376738138, 
                 0.369093: 0.14939981637785113, 0.369084: 0.17691993619206373, 0.370073: 0.2056250852722177, 0.370062: 0.23573532277264558, 
                 0.370048: 0.263909651664485, 0.370028: 0.2942517408209965, 0.369: 0.3234759032863223, 0.368: 0.349377927190955, 0.367: 0.3742390949490714, 
                 0.366: 0.3969320844043667, 0.365: 0.4156891030047927, 0.363: 0.43114259212603917, 0.362: 0.4420634839749435, 0.36: 0.450473426480799, 
                 0.358: 0.4558810944662055, 0.355: 0.45873560429016225, 0.353: 0.460003769881227, 0.35: 0.46049741228196056, 0.348: 0.46114962668179826, 
                 0.345: 0.46249033406641354, 0.341: 0.464415679917976, 0.338: 0.46728358064668485, 0.335: 0.4710380821757252, 0.331: 0.47632610232731126, 
                 0.328: 0.4832819087313795, 0.324: 0.49131680509606257, 0.32: 0.5006791768052263, 0.316: 0.5103581014324642, 0.312: 0.5184948438702605, 
                 0.307: 0.525702263136827, 0.303: 0.5305404932257608, 0.299: 0.5321705741730948, 0.294: 0.530382098704968, 0.289: 0.5250781627286705, 
                 0.285: 0.5158065159710454, 0.28: 0.5025816304853147, 0.275: 0.48750953531226565, 0.27: 0.46830393492017575, 0.265: 0.4473036990535035, 
                 0.26: 0.42641126826461645, 0.255: 0.404394675557949, 0.25: 0.3824560981538117, 0.245: 0.36411112208722785, 0.24: 0.34670301042754215, 
                 0.235: 0.3328080698438875, 0.23: 0.32324178735074627, 0.225: 0.31830787068800404, 0.219: 0.318591398652988, 0.214: 0.3239978318947246, 
                 0.209: 0.33510492848224516, 0.204: 0.35007669973578, 0.199: 0.3716870710506816, 0.194: 0.3978241032924255, 0.189: 0.42667996023661187, 
                 0.184: 0.460490634213575, 0.179: 0.4986191544369053, 0.174: 0.535452189666389, 0.169: 0.5774983434482504, 0.164: 0.6200168157351769, 
                 0.159: 0.6602583790280259, 0.154: 0.7014076191663544, 0.149: 0.7423873552129888, 0.145: 0.7772432592622364, 0.14: 0.8121929753447211, 
                 0.135: 0.8429523253264779, 0.131: 0.8690304751130958, 0.126: 0.8899384662258379, 0.122: 0.904111141395816, 0.118: 0.9133293081596592, 
                 0.113: 0.916331300583089, 0.109: 0.9133480185211102, 0.105: 0.9044144661698051, 0.101: 0.8892096079996384, 0.097: 0.8690989037844525, 
                 0.093: 0.8419786710388864, 0.09: 0.8093974310421826, 0.086: 0.7752398202906642, 0.082: 0.7332872971299101, 0.079002: 0.6892821752593866, 
                 0.075004: 0.6443274345769349, 0.072005: 0.594501354095682, 0.069006: 0.5426020818963242, 0.065007: 0.4944368317848566, 0.062008: 0.4450541036636447, 
                 0.059009: 0.3925176098986035, 0.056009: 0.34042484350696983, 0.05301: 0.2935511469632563, 0.05001: 0.24396622296239157, 0.04801: 0.19707767077961258, 
                 0.04501: 0.15449620499779632, 0.04201: 0.11127661819780099, 0.04001: 0.06997238110829683, 0.03801: 0.03411633680903314, 0.03501: 0.004694198634961 
                 }

def modify_rgb(rgb_tuple, level=0.5):
    rgb_id = parse_rgb(rgb_tuple)
    intensity = find_apx_intensity(rgb_id)
    new_rgb = convert(rgb_tuple, intensity, level)
    new_rgb_int = round_int_rgb(new_rgb)
    return new_rgb_int

def parse_rgb(rgb_tuple):
    return float("0."+'{:03d}'.format(rgb_tuple[0])+'{:03d}'.format(rgb_tuple[1])+'{:03d}'.format(rgb_tuple[2]))

def find_apx_intensity(rgb_id):
    return min(intensity_rgb, key=lambda x:abs(x-rgb_id))

def convert(rgb_tuple, intensity, level):
    if intensity > 0:
        return (brigthness_level(rgb_tuple[0],intensity_rgb[intensity],level), brigthness_level(rgb_tuple[1],intensity_rgb[intensity],level), brigthness_level(rgb_tuple[2],intensity_rgb[intensity],level))
        
    return ((rgb_tuple[0]*level, rgb_tuple[1]*level, rgb_tuple[2]*level))

def brigthness_level(color, downgrade, level):
  return (color*level)*(1 + downgrade)

def rgb_int_to_float(rgb_int):
    return (float(rgb_int[0]/255.00000), float(rgb_int[1]/255.00000),  float(rgb_int[2]/255.00000))

def round_int_rgb(rgb_tuple):
    return (round(rgb_tuple[0]),round(rgb_tuple[1]),round(rgb_tuple[2]))
